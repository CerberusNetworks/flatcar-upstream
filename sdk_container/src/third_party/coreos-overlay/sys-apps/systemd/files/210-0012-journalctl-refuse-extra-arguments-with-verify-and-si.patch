From 0c4b94ed59075c38da2aa30d162fc9f963d419aa Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zbigniew=20J=C4=99drzejewski-Szmek?= <zbyszek@in.waw.pl>
Date: Wed, 26 Feb 2014 23:01:43 -0500
Subject: journalctl: refuse extra arguments with --verify and similar

Positional arguments only make sense with the default action.
For other actions, complain instead of ignoring them silently.

(cherry picked from commit 0b6b7c2004317da48e5bbd3078c5662d8f0061b6)
---
 src/journal/journalctl.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/journal/journalctl.c b/src/journal/journalctl.c
index a328ba11b0d3..0619b256b959 100644
--- a/src/journal/journalctl.c
+++ b/src/journal/journalctl.c
@@ -658,6 +658,11 @@ static int parse_argv(int argc, char *argv[]) {
                 return -EINVAL;
         }
 
+        if (arg_action != ACTION_SHOW && optind < argc) {
+                log_error("Extraneous arguments starting with '%s'", argv[optind]);
+                return -EINVAL;
+        }
+
         return 1;
 }
 
-- 
1.9.0

